<!-- setPasswordForm -->
<form [formGroup]="setPasswordForm"
      (ngSubmit)="onSubmitSetPassowrdForm()">
    <div class="form-group">
        <label for="pwd">Définir un mot de passe</label>
        <input type="password"
               class="form-control"
               id="pwd"
               formControlName="password1">
        <!-- feedback to user : password pattern validity -->
        <div class="pattern"
             [class.pattern-verified-ok]="isPasswordPatternVerified()">
            <div class="password-validation">
                <span [class.valid]="setPasswordForm.controls['password1'].value.match('^(?=.*[A-Z])')">
                    @if(setPasswordForm.controls['password1'].value.match('^(?=.*[A-Z])')){
                    <i class="bi bi-check"></i>
                    }
                    @else {<i class="bi bi-x"></i>}
                    Majuscule
                </span>

                <span [class.valid]="setPasswordForm.controls['password1'].value.match('^(?=.*[a-z])')">
                    @if(setPasswordForm.controls['password1'].value.match('^(?=.*[a-z])')){
                    <i class="bi bi-check"></i>
                    }
                    @else {<i class="bi bi-x"></i>}
                    Minuscule
                </span>

                <span [class.valid]="setPasswordForm.controls['password1'].value.match('(.*[0-9].*)')">
                    @if(setPasswordForm.controls['password1'].value.match('(.*[0-9].*)')){
                    <i class="bi bi-check"></i>
                    }
                    @else {<i class="bi bi-x"></i>}
                    Chiffre
                </span>
            </div>

            <div class="password-validation">

                <span [class.valid]="setPasswordForm.controls['password1'].value.match('(?=.*[@$!%*#?&^_-])')">
                    @if(setPasswordForm.controls['password1'].value.match('(?=.*[@$!%*#?&^_-])')){
                    <i class="bi bi-check"></i>
                    }
                    @else {<i class="bi bi-x"></i>}
                    Caractère spécial
                </span>

                <span [class.valid]="!setPasswordForm.controls['password1'].hasError('minlength')">
                    @if(!setPasswordForm.controls['password1'].hasError('minlength') &&
                    !setPasswordForm.controls['password1'].hasError('required')) {
                    <i class="bi bi-check"></i>
                    }
                    @else {<i class="bi bi-x"></i>}
                    +8 caractères
                </span>
            </div>

        </div>
    </div>

    <div class="form-group">
        <label for="pwd">Confirmer votre mot de passe</label>
        <input type="password"
               class="form-control"
               id="pwd"
               formControlName="password2">

        @if(setPasswordForm.get('password2')?.untouched){
        <p class="info">Les mots de passe doivent correspondre</p>
        }

        @if(setPasswordForm.hasError('passwordNoMatch')
        && setPasswordForm.get('password2')?.touched
        && !setPasswordForm.get('password2')?.hasError('minlength')) {
        <p class="error">Les mots de passe ne correspondent pas</p>
        }

        @if(!setPasswordForm.hasError('passwordNoMatch')
        && setPasswordForm.get('password2')?.touched
        && !setPasswordForm.get('password2')?.hasError('minlength')) {
        <p class="success">Les mots de passe correspondent</p>
        }

    </div>

    <div class="form-group">
        <button type="submit"
                class="btn btn-primary w-100">Envoyer</button>
    </div>
</form>